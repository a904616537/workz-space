{"version":3,"sources":["webpack:///src/views/bottomBar.vue","webpack:///./src/views/bottomBar.vue?2609","webpack:///./src/views/bottomBar.vue"],"names":["bottomBar","name","methods","getUrlParam","reg","RegExp","r","window","location","search","substr","match","unescape","onWechatLogin","workspace_id","href","toWechat","console","log","this","toWechatUrl","onInit","_this","code","Object","api","then","result","openid","getUser","catch","err","_this2","user","$store","dispatch","$router","push","path","query","_id","lib_message_default","a","error","created","views_bottomBar","render","_h","$createElement","_c","_self","_v","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"+LAYAA,GACAC,KAAA,YACAC,SACAC,YADA,SACAF,GACA,IAAAG,EAAA,IAAAC,OAAA,QAAAJ,EAAA,iBACAK,EAAAC,OAAAC,SAAAC,OAAAC,OAAA,GAAAC,MAAAP,GACA,aAAAE,EAAAM,SAAAN,EAAA,UAEAO,cANA,SAMAC,GAKAP,OAAAC,SAAAO,KADAD,EACA,wMAEA,+IAAAA,EAAA,uEAIAE,SAjBA,WAsBAC,QAAAC,IAAA,QACAC,KAAAC,eAGAC,OA1BA,WA0BA,IAAAC,EAAAH,KACAL,EAAAK,KAAAhB,YAAA,aACAoB,EAAAJ,KAAAhB,YAAA,QACAoB,EACgBC,OAAAC,EAAA,EAAAD,EAAhBD,SACAG,KAAA,SAAAC,GAAA,IACAC,EAAAD,EAAAC,OACAN,EAAAO,QAAAD,EAAAd,KAEAgB,MAAA,SAAAC,GAAAd,QAAAC,IAAA,QAAAa,KAEAZ,KAAAN,cAAAC,IAGAe,QAxCA,SAwCAD,EAAAd,GAAA,IAAAkB,EAAAb,KAEYK,OAAAC,EAAA,EAAAD,EAAZI,WACAF,KAAA,SAAAO,GACAhB,QAAAC,IAAA,OAAAe,GACAA,GACAD,EAAAE,OAAAC,SAAA,aAAAF,GACAnB,GAAAkB,EAAAI,QAAAC,MAAAC,KAAA,YAAAC,OAAAC,IAAA1B,MAEoB2B,EAAAC,EAApBC,MAAA,yBAGAb,MAAA,SAAAC,GACgBU,EAAAC,EAAhBC,MAAA,kBACA1B,QAAAC,IAAA,OAAAa,OAIAa,QA5DA,WA8DAzB,KAAAE,WCvEewB,GADEC,OAFjB,WAA0B,IAAaC,EAAb5B,KAAa6B,eAA0BC,EAAvC9B,KAAuC+B,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,eAA/D9B,KAA+DgC,GAAA,KAAAF,EAAA,eAExEG,oBCCjB,IAcAC,EAdyBC,EAAQ,OAcjCC,CACEvD,EACA6C,GATF,EAVA,SAAAW,GACEF,EAAQ,SAaV,KAEA,MAUeG,EAAA,QAAAJ,EAAiB","file":"static/js/7.06c58982a5e91854cdf4.js","sourcesContent":["<template>\n\t<div>\n\t\t<router-view/>\n\t\t<v-menu />\n\t</div>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex'\nimport {getuser, getcode} from '../api';\nimport { Message } from 'element-ui';\n\nexport default {\n    name    : 'BottomBar',\n    methods : {\n    \tgetUrlParam(name) {\n            const reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\");\n            const r = window.location.search.substr(1).match(reg);\n            if (r != null) return unescape(r[2]); return null;\n        },\n        onWechatLogin(workspace_id) {\n            // if(process.env.NODE_ENV == \"development\") {\n                // window.location.href = \"https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx1020286e395af06c&redirect_uri=http%3A%2F%2Ftest.h-fish.cn&response_type=code&scope=snsapi_userinfo&state=123#wechat_redirect\";\n            // } else {\n            if(workspace_id) {\n                window.location.href = \"https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx1020286e395af06c&redirect_uri=http%3A%2F%2Fstore.workspace.h-fish.vip/&response_type=code&scope=snsapi_userinfo&state=123#wechat_redirect\";\n            } else {\n                window.location.href = `https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx1020286e395af06c&redirect_uri=http%3A%2F%2Fstore.workspace.h-fish.vip?workspace=${workspace_id}&response_type=code&scope=snsapi_userinfo&state=123#wechat_redirect`;\n            }\n            // }\n        },\n        toWechat() {\n            if(process.env.NODE_ENV == \"development\") {\n                console.log('测试玩家登陆');\n                this.toTestWchatUrl()\n            } else {\n                console.log('正式版本')\n                this.toWechatUrl();\n            }\n        },\n        onInit() {\n            const workspace_id = this.getUrlParam('workspace');\n            const code = this.getUrlParam('code');\n            if(code) {\n                getcode({code})\n                .then(result => {\n                    const {openid} = result;\n                    this.getUser(openid, workspace_id);\n                })\n                .catch(err => {console.log('error', err)});\n            } else {\n                this.onWechatLogin(workspace_id);\n            }  \n        },\n        getUser(openid, workspace_id) {\n            // getuser({openid : 'oJegnv-RgdwmlinNILZxWsUap8Og'})\n            getuser({openid})\n            .then(user => {\n                console.log('user', user)\n                if(user) {\n                    this.$store.dispatch('user/login', user);\n                    if(workspace_id) this.$router.push({ path: 'workspace', query : {_id : workspace_id}})\n                } else {\n                    Message.error('请先关注 WorkzSpace 公众号')\n                }\n            })\n            .catch(err => {\n                Message.error('user get error')\n                console.log('获取失败', err)\n            })\n        }\n    },\n    created() {\n        // this.getUser()\n        this.onInit(); \n    }\n}\n</script>\n\n<style lang=\"scss\">\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/bottomBar.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('router-view'),_vm._v(\" \"),_c('v-menu')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-58655fe0\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/bottomBar.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-58655fe0\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./bottomBar.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./bottomBar.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./bottomBar.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-58655fe0\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./bottomBar.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/bottomBar.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}